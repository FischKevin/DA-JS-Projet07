import{recipes as e}from"./recipes.js";import{recipesFactory as r}from"./factories/recipeFactory.js";import{updateRecipeCount as t}from"./utils.js";import{updateListOptions as n}from"./handleDropDown.js";import{filteredRecipesState as c}from"./searchTag.js";import{searchByTags as o}from"./searchTag.js";export let currentSearchQuery="";document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".header--input"),r=document.querySelector(".addedTags");e.addEventListener("input",()=>{currentSearchQuery=e.value.trim().toLowerCase(),applyFilters()}),r.addEventListener("change",()=>{let e=o();e&&(c.filteredRecipesByTags=e),currentSearchQuery&&currentSearchQuery.length>=3&&(e=searchRecipes(currentSearchQuery,e)),updateRecipeSection(e)})});export function searchRecipes(r,t=e){let n=[],c=r.split(" ");for(let o=0;o<t.length;o++){let{name:i,ingredients:a,description:s}=t[o],l=i.toLowerCase()+" "+s.toLowerCase();for(let p=0;p<a.length;p++)l+=" "+a[p].ingredient.toLowerCase();let u=!0;for(let h=0;h<c.length;h++){let d=c[h].toLowerCase(),f=!1;for(let g=0;g<=l.length-d.length;g++)if(l.substring(g,g+d.length)===d){f=!0;break}if(!f){u=!1;break}}u&&n.push(t[o])}return n}export function updateRecipeSection(e){if(!e){console.error("matchedRecipes is undefined");return}let c=document.querySelector(".recipeSection");if(c.textContent="",0===e.length){let o=document.createElement("p");o.classList.add("errorMessage"),o.textContent=`Aucune recette ne contient ‘${document.querySelector(".header--input").value.trim()}’ vous pouvez chercher \xab tarte aux pommes \xbb, \xab poisson \xbb, etc.`,c.appendChild(o)}else e.forEach(e=>{let t=r(e);c.appendChild(t)});t(e),n(e)}export function applyFilters(){let r=e;c.filteredRecipesByTags.length>0&&(r=c.filteredRecipesByTags),currentSearchQuery&&currentSearchQuery.length>=3&&(r=searchRecipes(currentSearchQuery,r)),updateRecipeSection(r)}